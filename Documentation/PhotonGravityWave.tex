\documentclass{article}
\usepackage{amsmath,scalefnt,fullpage}
\begin{document}
\begin{flushleft}
{\large Building a Numerical Model of the Influence of a Gravitational Wave on an Electromagnetic Wave}

The Physics behind PhotonGravityWavePerpendicularCase.py and PhotonGravityWave(2+1)-D.py

\smallskip
Varadarajan Srinivasan
\smallskip
\end{flushleft}

Let us define a left-handed\footnote{This orientation is more convenient for our computational system because its natural 2D origin is at the top-left corner.} coordinate system along whose xy plane electromagnetic waves can travel. Consider a gravitational wave propagating along the z-axis. Let us further define the x- and y-axes to be along the polarization axes of the gravitational wave. This has the effect of stretching and contracting space along those 2 axes. So, the wave equation in the presence of a gravitational wave can be written (taking out the the time component because it will not be affected) as
\begin{equation} \label{waveeqn with grav}
\begin{pmatrix}\partial_x & \partial_y & \partial_z\end{pmatrix} 
\textbf{M}
\begin{pmatrix} \partial_x \\ \partial_y \\ \partial_z \end{pmatrix}
u
=\frac{1}{c^2}\frac{\partial^2 u}{\partial t^2},
\end{equation}
where $\textbf{M}$ is the space component of the metric tensor and is represented by
\begin{equation} \label{M}
\textbf{M}=\begin{pmatrix}
1+f \\
 & 1-f \\
 & & 1
\end{pmatrix},
\text{ \ \ \ where } f=\epsilon \cos(kz-kct).
\end{equation}
Note that when the amplitude $\epsilon$ is 0, Eq. \ref{waveeqn with grav} reduces to the standard wave equation with no gravitational wave (i.e. flat spacetime),
\begin{equation} \label{waveeqn flat}
\nabla^2u=\frac{1}{c^2}\frac{\partial^2u}{\partial t^2}.
\end{equation}

Let us generalize this for any inclination of the gravitational wave. We need not generalize for azimuthal angle because we can always define a planar axis along the azimuthal direction of the wave. First, let us define a left-handed coordinate system $\langle x\prime,y\prime,z\prime\rangle$ attached to the gravitational wave such that $x\prime$ and $y\prime$ are along its polarization axes with $z\prime$ along its propagation direction. Second, we must also define a left-handed coordinate system $\langle X,Y,Z \rangle$ fixed to our frame of interest whose XY plane contains those electromagnetic waves. The latter is the frame our computational algorithms will use; the rows and columns of the numerical method form the discretized representation of the plane. The row indices and column indices correspond to Y-values and X-values respectively with (0,0) as the top-left corner. Note that our initial coordinate system $\langle x,y,z\rangle$ was equivalent to both $\langle X,Y,Z\rangle$ and $\langle x\prime,y\prime,z\prime\rangle$ as that was the case where the gravitational wave is perpendicular to the plane. In our new frame, our tensor $\textbf{M}$ takes $f=\epsilon \cos(kz\prime-kct)$ with t unchanged.

We know that we can always find a rotation matrix $\textbf{R}$ such that
\begin{equation} \label{R}
\begin{pmatrix}
X \\
Y \\
Z
\end{pmatrix}=\textbf{R}\begin{pmatrix}
x\prime \\
y\prime \\
z\prime
\end{pmatrix}.
\end{equation} Since the rotation matrix must be orthogonal, $\textbf{R}^{-1}=\textbf{R}^T$. Therefore, transposing both sides of Eq. \ref{R} shows that $\begin{pmatrix} X & Y & Z\end{pmatrix} = \begin{pmatrix}x\prime & y\prime & z\prime\end{pmatrix}\textbf{R}^{-1}.$ We can now rewrite the left hand side of Eq. \ref{waveeqn with grav} as
\begin{align}
LHS &= \begin{pmatrix}\partial_{x\prime} & \partial_{y\prime} & \partial_{z\prime}\end{pmatrix} 
\textbf{R}^{-1}\textbf{R} \  \textbf{M} \ \textbf{R}^{-1}\textbf{R}
\begin{pmatrix} \partial_{x\prime} \\ \partial_{y\prime} \\ \partial_{z\prime} \end{pmatrix}
u \nonumber \\
&= \begin{pmatrix}\partial_X & \partial_Y & \partial_Z\end{pmatrix}
\textbf{R} \  \textbf{M} \ \textbf{R}^{-1}
\begin{pmatrix} \partial_X \\ \partial_Y \\ \partial_Z \end{pmatrix}
u. \label{LHS}
\end{align}
Let us define another tensor $\textbf{T}\equiv\textbf{RMR}^{-1}$, the conjugate of $\textbf{M}$ by rotation. We can characterize the rotation required to go from the gravitational wave coordinate system to our computational coordinate system as Euler angle rotations about $z\prime,x\prime,z\prime$, but we have enough freedom in our coordinates to be able to always orient our $\langle X,Y,Z\rangle$ such that the last roll rotation about the new $z\prime$ axis does nothing. Thus, for an angle of incidence of $\theta$,\footnote{Note that $\theta$ is defined clockwise when viewed from above the YZ plane because our coordinate system is left-handed.}
\begin{equation} \label{R explicit}
\textbf{R}=
\textbf{R}_{z\prime}\textbf{R}_{x\prime}
=
\left(
\begin{array}{ccc}
 \cos (\theta ) & -\cos (\theta ) \sin (\theta ) & \sin ^2(\theta ) \\
 \sin (\theta ) & \cos ^2(\theta ) & -\cos (\theta ) \sin (\theta ) \\
 0 & \sin (\theta ) & \cos (\theta ) \\
\end{array}
\right)
\end{equation}
and hence
\begin{equation} \label{T}
\textbf{T}=
\begin{pmatrix}
 \frac{1}{8} (4 f \cos (2 \theta )+f \cos (4 \theta )+3 f+8) & \frac{1}{8} f (6 \sin (2 \theta )+\sin (4 \theta ))
   & f \sin ^2(\theta ) \cos (\theta ) \\
 \frac{1}{8} f (6 \sin (2 \theta )+\sin (4 \theta )) & \frac{1}{8} (-8 f \cos (2 \theta )-f \cos (4 \theta )+f+8)
   & -f \sin (\theta ) \cos ^2(\theta ) \\
 f \sin ^2(\theta ) \cos (\theta ) & -f \sin (\theta ) \cos ^2(\theta ) & \frac{1}{2} (f \cos (2 \theta )-f+2) \\
\end{pmatrix}
\end{equation}
We have introduced the parameter $\theta$ to convert between our two coordinate systems as our computations require all terms to be in the $\langle X,Y,Z\rangle$ system, but recall that $f=f(t,z\prime)=\epsilon \cos(kz\prime-kct)$. We therefore need to solve Eq. \ref{R} for the primed column vector with $\textbf{R}$ as above about $x\prime$,
\begin{equation*}
\begin{pmatrix}
x\prime \\
y\prime \\
z\prime
\end{pmatrix}
= \textbf{R}^{T}\begin{pmatrix}
X \\
Y \\
Z
\end{pmatrix}
=
\left(
\begin{array}{c}
 X \cos (\theta )+Y \sin (\theta ) \\
 \frac{1}{2} (-X \sin (2 \theta )+Y \cos (2 \theta )+2 Z \sin (\theta )+Y) \\
 X \sin ^2(\theta )+\cos (\theta ) (Z-Y \sin (\theta )) \\
\end{array}
\right)
\end{equation*}
Thus, \begin{equation} \label{f}
f=f(t,X,Y,Z)=\epsilon \cos\big(k\big(X \sin ^2(\theta )+\cos (\theta ) \big(Z-Y \sin (\theta )\big)-ct\big)\big).
\end{equation}
This puts $LHS = \nabla^T \textbf{T} \nabla u$, the compact form of Eq. \ref{LHS}, entirely in terms of our computational coordinates $X,Y,Z$. Hence, we have the desired form of the generalized (3+1)-dimensional equation describing the displacement $u(t,X,Y,Z)$ of an electromagnetic field (or, in fact, anything else obeying Eq. \ref{waveeqn flat}, the Wave Equation) interacting with a gravitational wave,
\begin{equation}\label{main eqn}
\boxed{
\nabla^T \textbf{T} \nabla u = \frac{1}{c^2}\frac{\partial^2 u}{\partial t^2} \ \ \ \ \mbox{with } f=f(t,X,Y,Z).
}
\end{equation}

To numerically compute results, we must discretize Eq. \ref{main eqn}. Our process for this will build on that already described in WaveEquation.pdf. Our plane of interest containing the electromagnetic waves is the XY plane and so we need only concern ourselves with the case Eq. \ref{f}, $f=f(t,X,Y,0)=\epsilon \cos\big(k\big(X \sin ^2(\theta )-Y\cos (\theta ) \sin (\theta )-ct\big)\big).$ We define $m,n,o$ as the row, column, and depth indices, respectively, of our numerical displacement function $u_{m,n,o,t}$. This means that, in our conveniently left-handed system, $m,n,o$ are the discretized Y-, X-, and Z-coordinates, respectively. Let us generalize the numerical first derivative from WaveEquation.pdf (using the notation and names defined there) to numerical partial derivatives. For a function $g(t,X,Y,Z)$,
\begin{align} \label{nDX and nDY}
\begin{split}
&\frac{\partial g}{\partial X} \approx \mbox{nD}_X(g_{m,n,o,t})=\frac{g_{m,n+1,o,t}-g_{m,n-1,o,t}}{2\Delta}, \\ 
&\frac{\partial g}{\partial Y} \approx \mbox{nD}_Y(g_{m,n,o,t})=\frac{g_{m+1,n,o,t}-g_{m-1,n,o,t}}{2\Delta}, \\
&\text{and similarly for $Z$ (index $o$, step size $\Delta$) and $t$ (index $t$, step size $\Delta t$).}
\end{split}
\end{align}
Using Eq. \ref{T}, the left hand side of our final result, Eq. \ref{main eqn}, is expanded as ...............@!!!!!!!!...WRONG:
\begin{align} \label{expanded LHS}
LHS &=
\nabla^T \begin{pmatrix}
1+f & 0 & 0 \\
0 & 1-f\cos^2\theta & -f\cos\theta\sin\theta \\
0 & -f\cos\theta\sin\theta & 1-f\sin^2\theta
\end{pmatrix} \nabla u \nonumber \\
&=
\frac{\partial}{\partial X}\left((1+f)\frac{\partial u}{\partial X}\right)+\frac{\partial}{\partial Y}\left((1-f\cos^2\theta)\frac{\partial u}{\partial Y}-f\cos\theta\sin\theta\ \frac{\partial u}{\partial Z} \right)\\ 
&\qquad+\frac{\partial}{\partial Z}\left(-f\cos\theta\sin\theta\ \frac{\partial u}{\partial Y} + (1-f\sin^2\theta)\frac{\partial u}{\partial Z}\right) \nonumber
\end{align}
We can directly apply Eqs. \ref{nDX and nDY} to discretize this. For later convenience, let us also multiply Eqs. \ref{nDX and nDY} by the spatial step size $\Delta$ and multiply the discretized form of Eq. \ref{expanded LHS} by $\Delta^2$. This allows us to put $LHS$ in terms of two functions, $\Delta\cdot\mbox{nD}_X$ and $\Delta\cdot\mbox{nD}_Y$, which are independent of parameters.\footnote{It is easy to check that this useful trick is allowed because $\mbox{nD}(kg)=k\mbox{nD}(g)$ for scalar k as $\mbox{nD}$ is, in principle, a linear transformation.}
\begin{align} \label{delsqrLHS}
\Delta^2 &\cdot LHS_{discr} = \Delta\cdot\mbox{nD}_X\big((1+f)\Delta\cdot\mbox{nD}_X(u_{m,n,o,t})\big) \\
+&\Delta \cdot\mbox{nD}_Y\big((1-f\cos^2\theta)\Delta\cdot\mbox{nD}_Y(u_{m,n,o,t})-f\cos\theta\sin\theta\Delta\cdot\mbox{nD}_Z(u_{m,n,o,t}) \big) \nonumber \\
+&\Delta \cdot\mbox{nD}_Z\big(-f\cos\theta\sin\theta\Delta\cdot\mbox{nD}_Y(u_{m,n,o,t}) + (1-f\sin^2\theta)\Delta\cdot\mbox{nD}_Z(u_{m,n,o,t})\big) \nonumber
\end{align}
The right hand side of Eq. \ref{main eqn} is easily discretized in time. Equating that to $LHS_{discr}$ gives us the fully discretized form of Eq. \ref{main eqn},
\begin{equation} \label{discr1}
\frac{1}{\Delta^2}\ \Delta^2 \cdot LHS_{discr} = \frac{1}{c^2}\ \mbox{nD}_t(\mbox{nD}_t(u_{m,n,o,t})).
\end{equation}
Applying Eqs. \ref{nDX and nDY} to Eq. \ref{discr1} and collecting parameters on one side, we finally have our desired iterative equation that solves the wave equation in the presence of a gravitational wave.
\begin{align} \label{discr main eqn}
\boxed{
u_{m,n,o,t+1}=\left(c\ \frac{\Delta t}{\Delta}\right)^2 \Delta^2 \cdot LHS_{discr}-u_{m,n,o,t-1}+2u_{m,n,o,t}
} \\
\text{with $\Delta^2 \cdot LHS_{discr}$ given by Eq. \ref{delsqrLHS}.} \nonumber
\end{align}
Our trick to remove parameters from within the numerical functions allows us to program them independently of parameters while accumulating all the parameters into
\begin{equation} \label{K}
K\equiv\left(c\ \frac{\Delta t}{\Delta}\right)^2=\left(\frac{c}{c_i}\right)^2
\end{equation}
that we discussed in detail in WaveEquation.pdf. Its constraint conditions apply here as well.
\end{document}

